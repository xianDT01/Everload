<div class="dashboard">
  <h2 class="dashboard-title">🚀 Panel de control EverLoad</h2>

<div class="platform-buttons">
  <a routerLink="/youtube-downloads" class="platform youtube">
    <img src="/assets/youtube-icon-logo-719479.png" class="icon"> YouTube
  </a>
  <a routerLink="/twitter-downloads" class="platform twitter">
    <img src="/assets/twitter-icon.png" class="icon"> Twitter
  </a>
  <a routerLink="/facebook-downloads" class="platform facebook">
    <img src="/assets/fb sin fondo.png" class="icon"> Facebook
  </a>
  <a routerLink="/instagram-downloads" class="platform instagram">
    <img src="/assets/instagram-icon.png" class="icon"> Instagram
  </a>
  <a routerLink="/spotify-downloads" class="platform spotify">
    <img src="/assets/Spotify.png" class="icon"> Spotify
  </a>
  <a routerLink="/tiktok-downloads" class="platform tiktok">
    <img src="/assets/tiktok_logo.png" class="icon"> TikTok
  </a>
</div>


  <form (ngSubmit)="guardarCambios()" *ngIf="config" class="form-grid">
    <label>Client ID Spotify:</label>
    <input [(ngModel)]="config.clientId" name="clientId" required />

    <label>Client Secret Spotify:</label>
    <input [(ngModel)]="config.clientSecret" name="clientSecret" required />

    <label>API Key de YouTube:</label>
    <input [(ngModel)]="config.apiKey" name="apiKey" required />

    <button type="submit" class="btn primary" [disabled]="cargando">💾 Guardar</button>
  </form>

  <p *ngIf="mensaje" class="message">{{ mensaje }}</p>

  <div class="actions-row">
    <button (click)="actualizarYtDlp()" class="btn secondary" [disabled]="cargando">🔄 Actualizar yt-dlp</button>
    <button (click)="limpiarTemporales()" class="btn warning">🧹 Limpiar temporales</button>
    <button (click)="vaciarHistorial()" class="btn danger">🗑️ Vaciar historial</button>
    <button (click)="limpiarLog()" class="btn dark">🧽 Limpiar log</button>
  </div>

  <p>{{ mensajeLimpieza }}</p>
  <p>{{ mensajeVaciarHistorial }}</p>
  <p>{{ mensajeLogLimpio }}</p>

  <hr />
  <h3>📜 Logs recientes</h3>
  <div class="logs-section">
    <input [(ngModel)]="filtroLog" placeholder="Filtrar por palabra (opcional)">
    <button class="btn small" (click)="cargarLogs()">🔍 Ver logs</button>
  </div>

  <div #logContainer class="log-output">
    <div *ngFor="let l of logs">{{ l }}</div>
  </div>

  <hr />
 <h3>📂 Historial de descargas</h3>
<div class="history-container">
  <table *ngIf="historial.length > 0" class="history-table">
    <thead>
      <tr>
        <th>Título</th>
        <th>Tipo</th>
        <th>Plataforma</th>
        <th>Fecha</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of historial">
        <td>{{ item.titulo }}</td>
        <td>{{ item.tipo }}</td>
        <td>
          <img [src]="getIconPath(item.plataforma)" class="icon-table" />
          {{ item.plataforma }}
        </td>
        <td>{{ item.fecha | date:'short' }}</td>
      </tr>
    </tbody>
  </table>
</div>

<!-- ¡IMPORTANTE! Este bloque ahora está FUERA del .history-container -->
<h3>📶 Estado de las APIs</h3>
<div class="api-status">
  <button (click)="comprobarApis()" class="btn secondary">🔍 Comprobar estado</button>
  <ul>
    <li><strong>YouTube:</strong> {{ apiEstados['youtube'] }}</li>
    <li><strong>Spotify:</strong> {{ apiEstados['spotify'] }}</li>
    <li><strong>TikTok:</strong> {{ apiEstados['tiktok'] }}</li>
    <li><strong>Facebook:</strong> {{ apiEstados['facebook'] }}</li>
    <li><strong>Instagram:</strong> {{ apiEstados['instagram'] }}</li>
  </ul>
</div>





</div>

