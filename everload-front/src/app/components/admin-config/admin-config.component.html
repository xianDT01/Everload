<div class="dashboard">
  <h2 class="dashboard-title">ğŸš€ Panel de control EverLoad</h2>

  <form (ngSubmit)="guardarCambios()" *ngIf="config" class="form-grid">
    <label>Client ID Spotify:</label>
    <input [(ngModel)]="config.clientId" name="clientId" required />

    <label>Client Secret Spotify:</label>
    <input [(ngModel)]="config.clientSecret" name="clientSecret" required />

    <label>API Key de YouTube:</label>
    <input [(ngModel)]="config.apiKey" name="apiKey" required />

    <button type="submit" class="btn primary" [disabled]="cargando">ğŸ’¾ Guardar</button>
  </form>

  <p *ngIf="mensaje" class="message">{{ mensaje }}</p>

  <div class="actions-row">
    <button (click)="actualizarYtDlp()" class="btn secondary" [disabled]="cargando">ğŸ”„ Actualizar yt-dlp</button>
    <button (click)="limpiarTemporales()" class="btn warning">ğŸ§¹ Limpiar temporales</button>
    <button (click)="vaciarHistorial()" class="btn danger">ğŸ—‘ï¸ Vaciar historial</button>
    <button (click)="limpiarLog()" class="btn dark">ğŸ§½ Limpiar log</button>
  </div>

  <p>{{ mensajeLimpieza }}</p>
  <p>{{ mensajeVaciarHistorial }}</p>
  <p>{{ mensajeLogLimpio }}</p>

  <hr />
  <h3>ğŸ“œ Logs recientes</h3>
  <div class="logs-section">
    <input [(ngModel)]="filtroLog" placeholder="Filtrar por palabra (opcional)">
    <button class="btn small" (click)="cargarLogs()">ğŸ” Ver logs</button>
  </div>

  <div #logContainer class="log-output">
    <div *ngFor="let l of logs">{{ l }}</div>
  </div>

  <hr />
  <h3>ğŸ“‚ Historial de descargas</h3>

  <table *ngIf="historial.length > 0" class="history-table">
    <thead>
      <tr>
        <th>TÃ­tulo</th>
        <th>Tipo</th>
        <th>Plataforma</th>
        <th>Fecha</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of historial">
        <td>{{ item.titulo }}</td>
        <td>{{ item.tipo }}</td>
        <td>{{ item.plataforma }}</td>
        <td>{{ item.fecha | date:'short' }}</td>
      </tr>
    </tbody>
  </table>
</div>
